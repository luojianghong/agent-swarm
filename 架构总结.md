# Agent Swarm é¡¹ç›®æ¶æ„æ€»ç»“

> æœ¬æ–‡æ¡£å…¨é¢åˆ†æäº† Agent Swarm é¡¹ç›®çš„æ¶æ„ã€æŠ€æœ¯æ ˆã€æ ¸å¿ƒåŠŸèƒ½å’Œç¬¬ä¸‰æ–¹ä¾èµ–ã€‚

---

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**Agent Swarm** æ˜¯ä¸€ä¸ªå¤šæ™ºèƒ½ä½“ç¼–æ’ç³»ç»Ÿï¼Œä¸“ä¸º Claude Codeã€Codexã€Gemini CLI ç­‰ AI ç¼–ç åŠ©æ‰‹è®¾è®¡ã€‚å®ƒå®ç°äº†ä¸€ä¸ªåˆ†å¸ƒå¼çš„ AI ä»£ç†åä½œæ¡†æ¶ï¼Œæ”¯æŒä»»åŠ¡åˆ†é…ã€ä»£ç†é€šä¿¡å’ŒæœåŠ¡å‘ç°ã€‚

**æ ¸å¿ƒä»·å€¼**ï¼š
- ğŸ¤– å¤šä»£ç†ååŒå·¥ä½œï¼ˆLead + Workers æ¶æ„ï¼‰
- ğŸ³ Docker å®¹å™¨éš”ç¦»è¿è¡Œç¯å¢ƒ
- ğŸ’¬ é›†æˆ Slackã€GitHubã€Email å¤šæ¸ é“ä»»åŠ¡è¾“å…¥
- ğŸ§  æŒä¹…åŒ–è®°å¿†ç³»ç»Ÿï¼Œä»£ç†ä¼šä¸æ–­å­¦ä¹ è¿›åŒ–
- ğŸ“Š å®æ—¶ç›‘æ§ä»ªè¡¨æ¿

**ç‰ˆæœ¬**: 1.28.1  
**è®¸å¯**: MIT  
**ä½œè€…**: desplega.sh

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **è¿è¡Œæ—¶**: Bunï¼ˆé Node.jsï¼‰
- **è¯­è¨€**: TypeScriptï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰
- **æ•°æ®åº“**: SQLiteï¼ˆWAL æ¨¡å¼ï¼‰
- **MCP åè®®**: @modelcontextprotocol/sdk
- **CLI æ¡†æ¶**: Inkï¼ˆReact for Terminalï¼‰
- **ä»£ç è§„èŒƒ**: Biomeï¼ˆ2 ç©ºæ ¼ç¼©è¿›ï¼ŒåŒå¼•å·ï¼‰

### æ¶æ„æ¨¡å¼

```
ç”¨æˆ·è¾“å…¥ï¼ˆSlack/GitHub/Email/CLIï¼‰
        â†“
   Lead Agentï¼ˆåè°ƒè€…ï¼‰
        â†“
   MCP API Server â†â†’ SQLite DB
        â†“
   â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”
Worker  Worker  Worker
ï¼ˆDocker å®¹å™¨ï¼Œå®Œæ•´å¼€å‘ç¯å¢ƒï¼‰
```

### å…³é”®ç»„ä»¶

#### 1. MCP API Server (`src/http.ts`)
- HTTP æœåŠ¡å™¨ï¼ˆç«¯å£ 3013ï¼‰
- æä¾› MCP å·¥å…·æ¥å£
- å¤„ç†ä»£ç†æ³¨å†Œã€ä»»åŠ¡åˆ†é…ã€æ¶ˆæ¯ä¼ é€’

#### 2. Lead Agentï¼ˆé¢†å¯¼ä»£ç†ï¼‰
- æ¥æ”¶ä»»åŠ¡è¯·æ±‚
- åˆ†è§£ä»»åŠ¡å¹¶åˆ†é…ç»™ Workers
- ç®¡ç†æ”¶ä»¶ç®±æ¶ˆæ¯ï¼ˆSlack/Emailï¼‰
- ä¸æ‰§è¡Œå…·ä½“ç¼–ç ä»»åŠ¡

#### 3. Worker Agentsï¼ˆå·¥ä½œä»£ç†ï¼‰
- åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œ
- æ‰§è¡Œå…·ä½“ç¼–ç ä»»åŠ¡
- å®Œæ•´çš„å¼€å‘ç¯å¢ƒï¼ˆPythonã€Node.jsã€Bunã€PM2ï¼‰
- å¯ä»¥è¿è¡Œåå°æœåŠ¡

---

## ğŸ’¾ æ•°æ®æ¨¡å‹

### æ ¸å¿ƒå®ä½“ï¼ˆ`src/types.ts`ï¼‰

#### 1. Agentï¼ˆä»£ç†ï¼‰
- **åŸºæœ¬ä¿¡æ¯**: id, name, isLead, status
- **èƒ½åŠ›æè¿°**: capabilities, role, description
- **èº«ä»½æ–‡ä»¶**: soulMd, identityMd, toolsMd, claudeMd, setupScript
- **å¹¶å‘æ§åˆ¶**: maxTasksï¼ˆé»˜è®¤ 1ï¼‰

#### 2. AgentTaskï¼ˆä»»åŠ¡ï¼‰
- **çŠ¶æ€æµè½¬**: backlog â†’ unassigned â†’ offered â†’ pending â†’ in_progress â†’ completed/failed/paused
- **ä»»åŠ¡æ± æœºåˆ¶**: æ”¯æŒæœªåˆ†é…ä»»åŠ¡ã€ä»»åŠ¡æä¾›ã€æ¥å—/æ‹’ç»
- **ä¾èµ–ç®¡ç†**: dependsOn æ•°ç»„
- **å¤šæ¸ é“å…ƒæ•°æ®**: Slackã€GitHubã€AgentMail

#### 3. InboxMessageï¼ˆæ”¶ä»¶ç®±æ¶ˆæ¯ï¼‰
- Lead ä»£ç†ä¸“ç”¨
- **çŠ¶æ€**: unread â†’ processing â†’ read/responded/delegated
- æ”¯æŒå§”æ´¾ä¸ºä»»åŠ¡

#### 4. AgentMemoryï¼ˆè®°å¿†ç³»ç»Ÿï¼‰
- **ä½œç”¨åŸŸ**: agentï¼ˆç§æœ‰ï¼‰/ swarmï¼ˆå…±äº«ï¼‰
- **æ¥æº**: manual, file_index, session_summary, task_completion
- æ”¯æŒå‘é‡æœç´¢ï¼ˆOpenAI embeddingsï¼‰

#### 5. Epicï¼ˆå²è¯—ä»»åŠ¡ï¼‰
- å¤§å‹é¡¹ç›®ç®¡ç†
- å…³è”å¤šä¸ªå­ä»»åŠ¡
- åŒ…å« PRDã€è®¡åˆ’æ–‡æ¡£

#### 6. ScheduledTaskï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰
- Cron è¡¨è¾¾å¼æˆ–é—´éš”æ—¶é—´
- è‡ªåŠ¨åˆ›å»ºä»»åŠ¡

#### 7. Serviceï¼ˆæœåŠ¡æ³¨å†Œï¼‰
- PM2 è¿›ç¨‹ç®¡ç†
- æœåŠ¡å‘ç°æœºåˆ¶
- å¥åº·æ£€æŸ¥

---

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### 1. ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸç®¡ç†

**ä»»åŠ¡çŠ¶æ€æœº**ï¼š
```
backlog â†’ unassigned â†’ offered â†’ reviewing â†’ pending 
    â†’ in_progress â†’ completed/failed/cancelled/paused
```

**ä»»åŠ¡æ± æœºåˆ¶**ï¼š
- Lead åˆ›å»ºæœªåˆ†é…ä»»åŠ¡ï¼ˆunassignedï¼‰
- Workers å¯ä»¥ä¸»åŠ¨è®¤é¢†ï¼ˆclaimï¼‰
- Lead å¯ä»¥æä¾›ç»™ç‰¹å®š Workerï¼ˆofferï¼‰
- Worker æ¥å—/æ‹’ç»ä»»åŠ¡

**ä¼˜é›…å…³é—­ä¸æ¢å¤**ï¼š
- å®¹å™¨å…³é—­æ—¶ä»»åŠ¡æ ‡è®°ä¸º `paused`
- é‡å¯åè‡ªåŠ¨æ¢å¤ï¼ˆåŸºäº AGENT_IDï¼‰
- ä¿ç•™ä»»åŠ¡è¿›åº¦å’Œä¸Šä¸‹æ–‡

### 2. ä»£ç†èº«ä»½ç³»ç»Ÿ

æ¯ä¸ªä»£ç†æœ‰ 4 ä¸ªèº«ä»½æ–‡ä»¶ï¼š

| æ–‡ä»¶ | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| **SOUL.md** | æ ¸å¿ƒäººæ ¼ã€ä»·å€¼è§‚ã€è¡Œä¸ºå‡†åˆ™ | "ä½ ä¸æ˜¯èŠå¤©æœºå™¨äººï¼Œè¦å½»åº•ã€æ‰¿è®¤é”™è¯¯" |
| **IDENTITY.md** | ä¸“ä¸šæŠ€èƒ½ã€å·¥ä½œé£æ ¼ã€å±¥å† | "æˆ‘æ˜¯ç¼–ç ä¸“å®¶ï¼Œå¿«é€Ÿäº¤ä»˜å¹²å‡€ä»£ç " |
| **TOOLS.md** | ç¯å¢ƒçŸ¥è¯†ã€ä»“åº“ã€æœåŠ¡ã€API | "API è¿è¡Œåœ¨ 3013 ç«¯å£ï¼Œä½¿ç”¨ wts ç®¡ç†å·¥ä½œæ ‘" |
| **CLAUDE.md** | æŒä¹…åŒ–ç¬”è®°å’ŒæŒ‡ä»¤ | å­¦ä¹ ç»éªŒã€åå¥½ã€é‡è¦ä¸Šä¸‹æ–‡ |

**è‡ªæˆ‘è¿›åŒ–**ï¼š
- ä»£ç†å¯ä»¥åœ¨ä¼šè¯ä¸­ç¼–è¾‘è¿™äº›æ–‡ä»¶
- å®æ—¶åŒæ­¥åˆ°æ•°æ®åº“ï¼ˆPostToolUse hookï¼‰
- ç‰ˆæœ¬å†å²è¿½è¸ªï¼ˆcontext_versions è¡¨ï¼‰

### 3. è®°å¿†ç³»ç»Ÿ

**è‡ªåŠ¨è®°å¿†åˆ›å»º**ï¼š
- ä¼šè¯æ€»ç»“ï¼ˆè½»é‡çº§æ¨¡å‹æå–å…³é”®å­¦ä¹ ï¼‰
- ä»»åŠ¡å®Œæˆè®°å½•ï¼ˆåŒ…æ‹¬å¤±è´¥åŸå› ï¼‰
- æ–‡ä»¶ç´¢å¼•ï¼ˆ`/workspace/personal/memory/` å’Œ `/workspace/shared/memory/`ï¼‰
- Lead æ³¨å…¥å­¦ä¹ ï¼ˆinject-learning å·¥å…·ï¼‰

**è®°å¿†æ£€ç´¢**ï¼š
- ä»»åŠ¡å¼€å§‹å‰è‡ªåŠ¨æœç´¢ç›¸å…³è®°å¿†
- OpenAI embeddingsï¼ˆtext-embedding-3-smallï¼‰
- å‘é‡ç›¸ä¼¼åº¦æœç´¢

### 4. Hook ç³»ç»Ÿ

6 ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆ`src/hooks/hook.ts`ï¼‰ï¼š

| Hook | è§¦å‘æ—¶æœº | åŠŸèƒ½ |
|------|---------|------|
| **SessionStart** | ä¼šè¯å¼€å§‹ | å†™å…¥ CLAUDE.mdï¼ŒåŠ è½½å¹¶å‘ä¼šè¯ä¸Šä¸‹æ–‡ |
| **PreCompact** | ä¸Šä¸‹æ–‡å‹ç¼©å‰ | æ³¨å…¥"ç›®æ ‡æé†’"é˜²æ­¢ä»£ç†è¿·å¤± |
| **PreToolUse** | å·¥å…·è°ƒç”¨å‰ | æ£€æŸ¥ä»»åŠ¡å–æ¶ˆã€æ£€æµ‹å·¥å…·å¾ªç¯ã€é˜»æ­¢è¿‡åº¦è½®è¯¢ |
| **PostToolUse** | å·¥å…·è°ƒç”¨å | å‘é€å¿ƒè·³ã€åŒæ­¥èº«ä»½æ–‡ä»¶ã€è‡ªåŠ¨ç´¢å¼•è®°å¿†æ–‡ä»¶ |
| **UserPromptSubmit** | æ–°è¿­ä»£å¼€å§‹ | æ£€æŸ¥ä»»åŠ¡å–æ¶ˆ |
| **Stop** | ä¼šè¯ç»“æŸ | ä¿å­˜ PM2 çŠ¶æ€ã€åŒæ­¥èº«ä»½æ–‡ä»¶ã€ä¼šè¯æ€»ç»“ã€æ ‡è®°ç¦»çº¿ |

### 5. é›†æˆèƒ½åŠ›

#### Slack é›†æˆ
- Socket Modeï¼ˆæ— éœ€å…¬ç½‘ webhookï¼‰
- ç›´æ¥æ¶ˆæ¯åˆ›å»ºä»»åŠ¡
- çº¿ç¨‹å›å¤è¿›åº¦æ›´æ–°
- ç”¨æˆ·è¿‡æ»¤ï¼ˆé‚®ç®±åŸŸå/ç”¨æˆ· IDï¼‰

#### GitHub é›†æˆ
- Webhook æ¥æ”¶äº‹ä»¶
- @mention åˆ›å»ºä»»åŠ¡
- PR åˆ†é…/å®¡æŸ¥è¯·æ±‚
- CI å¤±è´¥é€šçŸ¥
- Bot è¡¨æƒ…ååº”

#### AgentMail é›†æˆ
- ç»™ä»£ç†åˆ†é…é‚®ç®±åœ°å€
- é‚®ä»¶è½¬ä»»åŠ¡
- çº¿ç¨‹è‡ªåŠ¨è·¯ç”±

#### Sentry é›†æˆ
- `/investigate-sentry-issue` å‘½ä»¤
- è‡ªåŠ¨è·å–å †æ ˆè·Ÿè¸ª
- é—®é¢˜åˆ†ç±»å’Œè§£å†³

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
agent-swarm/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ cli.tsx              # CLI å…¥å£ï¼ˆInk/Reactï¼‰
â”‚   â”œâ”€â”€ http.ts              # HTTP æœåŠ¡å™¨ + MCP ç«¯ç‚¹
â”‚   â”œâ”€â”€ stdio.ts             # Stdio MCP ä¼ è¾“
â”‚   â”œâ”€â”€ server.ts            # MCP æœåŠ¡å™¨è®¾ç½® + å·¥å…·æ³¨å†Œ
â”‚   â”œâ”€â”€ types.ts             # æ ¸å¿ƒç±»å‹å®šä¹‰ï¼ˆZod schemasï¼‰
â”‚   â”œâ”€â”€ tools/               # MCP å·¥å…·å®ç°ï¼ˆ50+ å·¥å…·ï¼‰
â”‚   â”‚   â”œâ”€â”€ join-swarm.ts    # ä»£ç†æ³¨å†Œ
â”‚   â”‚   â”œâ”€â”€ poll-task.ts     # ä»»åŠ¡è½®è¯¢
â”‚   â”‚   â”œâ”€â”€ send-task.ts     # åˆ›å»ºä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ task-action.ts   # ä»»åŠ¡æ“ä½œï¼ˆclaim/accept/rejectï¼‰
â”‚   â”‚   â”œâ”€â”€ epics/           # å²è¯—ä»»åŠ¡ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ schedules/       # å®šæ—¶ä»»åŠ¡
â”‚   â”‚   â””â”€â”€ swarm-config/    # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ be/                  # åç«¯å·¥å…·
â”‚   â”‚   â”œâ”€â”€ db.ts            # SQLite æ•°æ®åº“ï¼ˆ1500+ è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ embedding.ts     # OpenAI å‘é‡åµŒå…¥
â”‚   â”‚   â””â”€â”€ chunking.ts      # æ–‡æœ¬åˆ†å—
â”‚   â”œâ”€â”€ commands/            # CLI å‘½ä»¤å®ç°
â”‚   â”‚   â”œâ”€â”€ worker.ts        # Worker è¿è¡Œå™¨
â”‚   â”‚   â”œâ”€â”€ lead.ts          # Lead è¿è¡Œå™¨
â”‚   â”‚   â”œâ”€â”€ runner.ts        # é€šç”¨è¿è¡Œå™¨é€»è¾‘
â”‚   â”‚   â””â”€â”€ setup.tsx        # é¡¹ç›®è®¾ç½®
â”‚   â”œâ”€â”€ hooks/               # Claude Code hooks
â”‚   â”‚   â”œâ”€â”€ hook.ts          # Hook å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ tool-loop-detection.ts  # å·¥å…·å¾ªç¯æ£€æµ‹
â”‚   â”œâ”€â”€ github/              # GitHub webhook å¤„ç†
â”‚   â”œâ”€â”€ slack/               # Slack é›†æˆ
â”‚   â”œâ”€â”€ agentmail/           # AgentMail é›†æˆ
â”‚   â””â”€â”€ scheduler/           # å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
â”œâ”€â”€ new-ui/                  # Next.js ä»ªè¡¨æ¿
â”œâ”€â”€ docs-site/               # Fumadocs æ–‡æ¡£ç«™ç‚¹
â”œâ”€â”€ landing/                 # Next.js è½åœ°é¡µ
â”œâ”€â”€ plugin/                  # Claude Code æ’ä»¶å®šä¹‰
â”‚   â”œâ”€â”€ commands/            # å‘½ä»¤æ¨¡æ¿ï¼ˆMarkdownï¼‰
â”‚   â”œâ”€â”€ agents/              # ä¸“ä¸šä»£ç†æ¨¡æ¿
â”‚   â””â”€â”€ hooks/               # Hook é…ç½®
â”œâ”€â”€ deploy/                  # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ Dockerfile.worker        # Worker é•œåƒï¼ˆUbuntu 24.04ï¼‰
â””â”€â”€ docker-compose.example.yml  # å®Œæ•´éƒ¨ç½²ç¤ºä¾‹
```

---

## ğŸ› ï¸ MCP å·¥å…·ç³»ç»Ÿ

### èƒ½åŠ›åˆ†ç»„ï¼ˆå¯é€šè¿‡ CAPABILITIES ç¯å¢ƒå˜é‡æ§åˆ¶ï¼‰

1. **core**ï¼ˆæ ¸å¿ƒï¼‰ï¼šjoin-swarm, poll-task, send-task, get-tasks, cancel-task
2. **task-pool**ï¼ˆä»»åŠ¡æ± ï¼‰ï¼štask-actionï¼ˆclaim/release/accept/rejectï¼‰
3. **messaging**ï¼ˆæ¶ˆæ¯ï¼‰ï¼šcreate-channel, post-message, read-messages
4. **profiles**ï¼ˆé…ç½®ï¼‰ï¼šupdate-profile, context-history, context-diff
5. **services**ï¼ˆæœåŠ¡ï¼‰ï¼šregister-service, list-services, update-service-status
6. **scheduling**ï¼ˆè°ƒåº¦ï¼‰ï¼šcreate-schedule, list-schedules, run-schedule-now
7. **epics**ï¼ˆå²è¯—ï¼‰ï¼šcreate-epic, assign-task-to-epic, get-epic-details
8. **memory**ï¼ˆè®°å¿†ï¼‰ï¼šmemory-search, memory-get, inject-learning

### å·¥å…·æ³¨å†Œæ¨¡å¼ï¼ˆ`src/tools/utils.ts`ï¼‰
- Zod schema éªŒè¯è¾“å…¥/è¾“å‡º
- ç»Ÿä¸€é”™è¯¯å¤„ç†
- ç»“æ„åŒ–å“åº”ï¼ˆcontent + structuredContentï¼‰
- è¯·æ±‚ä¿¡æ¯æ³¨å…¥ï¼ˆagentId, sessionIdï¼‰

---

## ğŸ³ Docker ç¯å¢ƒ

### Worker é•œåƒç‰¹æ€§
- **åŸºç¡€é•œåƒ**: Ubuntu 24.04
- **é¢„è£…å·¥å…·**: Python 3, Node.js 22, Bun, PM2, gh CLI, sqlite3
- **è‡ªå®šä¹‰å·¥å…·**: wtsï¼ˆgit worktree ç®¡ç†ï¼‰ã€cc-ai-trackerï¼ˆä»£ç å˜æ›´è¿½è¸ªï¼‰
- **Sudo æƒé™**: å¯å®‰è£…é¢å¤–åŒ…
- **å¯åŠ¨è„šæœ¬**: æ”¯æŒ `.sh`, `.js`, `.ts` æ ¼å¼

### å·æŒ‚è½½
- `/workspace/personal` - ä»£ç†ç§æœ‰å·¥ä½œåŒº
- `/workspace/shared` - å…±äº«å·¥ä½œåŒº
- `/logs` - ä¼šè¯æ—¥å¿—

---

## ğŸ“Š ç›‘æ§ä¸æ—¥å¿—

### æ—¥å¿—ç³»ç»Ÿ
1. **agent_log** - äº‹ä»¶æ—¥å¿—ï¼ˆä»£ç†åŠ å…¥ã€çŠ¶æ€å˜æ›´ã€ä»»åŠ¡å˜æ›´ï¼‰
2. **session_logs** - åŸå§‹ CLI è¾“å‡ºï¼ˆJSON è¡Œï¼‰
3. **session_costs** - ä¼šè¯æˆæœ¬ç»Ÿè®¡ï¼ˆtoken ä½¿ç”¨ã€è´¹ç”¨ï¼‰

### ä»ªè¡¨æ¿ï¼ˆnew-ui/ï¼‰
- å®æ—¶ä»£ç†çŠ¶æ€
- ä»»åŠ¡è¿›åº¦ç›‘æ§
- ä»£ç†é—´èŠå¤©
- æœåŠ¡å‘ç°

---

## ğŸ” å®‰å…¨ä¸è®¤è¯

- API_KEY Bearer token è®¤è¯
- X-Agent-ID å¤´éƒ¨æ ‡è¯†ä»£ç†
- Slack ç”¨æˆ·è¿‡æ»¤ï¼ˆé‚®ç®±åŸŸå/ç”¨æˆ· ID ç™½åå•ï¼‰
- GitHub webhook ç­¾åéªŒè¯
- AgentMail Svix webhook éªŒè¯

---

## ğŸš€ éƒ¨ç½²æ–¹å¼

1. **Docker Compose**ï¼ˆæ¨èï¼‰
   - API + Lead + å¤šä¸ª Workers
   - ä¸€é”®å¯åŠ¨å®Œæ•´é›†ç¾¤

2. **ç‹¬ç«‹ Docker Worker**
   - çµæ´»æ‰©å±•
   - è¿æ¥è¿œç¨‹ API

3. **systemd æœåŠ¡**
   - Linux æœåŠ¡å™¨éƒ¨ç½²
   - è‡ªåŠ¨é‡å¯å’Œå¥åº·æ£€æŸ¥

4. **Claude Code æœ¬åœ°**
   - Lead ä»£ç†ç›´æ¥è¿è¡Œ
   - æ— éœ€ Docker

---

## ğŸ’¡ åˆ›æ–°ç‰¹æ€§

### 1. è‡ªæˆ‘è¿›åŒ–çš„ä»£ç†
- ä»£ç†å¯ä»¥ä¿®æ”¹è‡ªå·±çš„èº«ä»½æ–‡ä»¶
- å­¦ä¹ ç»éªŒæŒä¹…åŒ–
- å¯åŠ¨è„šæœ¬è‡ªå®šä¹‰

### 2. ä»»åŠ¡æ± æœºåˆ¶
- æ”¯æŒä¸»åŠ¨è®¤é¢†å’Œè¢«åŠ¨åˆ†é…
- ä»»åŠ¡æä¾›/æ¥å—/æ‹’ç»æµç¨‹
- ä¾èµ–ç®¡ç†

### 3. ä¼˜é›…å…³é—­
- ä»»åŠ¡æš‚åœè€Œéå¤±è´¥
- è‡ªåŠ¨æ¢å¤ä¸Šä¸‹æ–‡
- é›¶åœæœºéƒ¨ç½²

### 4. æœåŠ¡æ³¨å†Œ
- PM2 è¿›ç¨‹ç®¡ç†
- æœåŠ¡å‘ç°
- å¥åº·æ£€æŸ¥

### 5. å¤šæ¸ é“é›†æˆ
- Slackã€GitHubã€Email ç»Ÿä¸€å…¥å£
- çº¿ç¨‹åŒ–å›å¤
- ä¸Šä¸‹æ–‡ä¿æŒ

---

## ğŸ“ˆ é€‚ç”¨åœºæ™¯

- âœ… å¤§å‹ä»£ç åº“ç»´æŠ¤ï¼ˆå¤šä»£ç†åä½œï¼‰
- âœ… è‡ªåŠ¨åŒ– PR å®¡æŸ¥å’Œé—®é¢˜åˆ†ç±»
- âœ… å®šæ—¶ä»»åŠ¡æ‰§è¡Œï¼ˆä»£ç å®¡è®¡ã€ä¾èµ–æ›´æ–°ï¼‰
- âœ… Slack/GitHub å·¥ä½œæµè‡ªåŠ¨åŒ–
- âœ… å¾®æœåŠ¡å¼€å‘ï¼ˆä»£ç†è¿è¡Œåå°æœåŠ¡ï¼‰
- âœ… ç ”ç©¶å’Œå­¦ä¹ å‹ä»»åŠ¡ï¼ˆè®°å¿†ç³»ç»Ÿï¼‰

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Bun ä¾èµ–**ï¼šå¿…é¡»ä½¿ç”¨ Bunï¼Œä¸å…¼å®¹ Node.js
2. **SQLite WAL æ¨¡å¼**ï¼šéœ€è¦åŒä¸€æ–‡ä»¶ç³»ç»Ÿï¼ˆDocker å·ï¼‰
3. **AGENT_ID ç¨³å®šæ€§**ï¼šä»»åŠ¡æ¢å¤éœ€è¦å›ºå®š ID
4. **å¹¶å‘é™åˆ¶**ï¼šé»˜è®¤æ¯ä¸ª Worker åªèƒ½å¤„ç† 1 ä¸ªä»»åŠ¡
5. **æˆæœ¬æ§åˆ¶**ï¼šAI è°ƒç”¨ä¼šäº§ç”Ÿè´¹ç”¨ï¼Œéœ€ç›‘æ§ session_costs

---

## ğŸ¤– AI æ¨¡å‹é›†æˆåˆ†æ

### é¡¹ç›®æ²¡æœ‰ä½¿ç”¨ LangGraph/LangChain

è¿™ä¸ªé¡¹ç›®**å®Œå…¨æ²¡æœ‰ä½¿ç”¨** LangGraph æˆ– LangChain æ¡†æ¶ã€‚å®ƒé‡‡ç”¨äº†ä¸€ä¸ªæ›´åº•å±‚ã€æ›´ç›´æ¥çš„æ¶æ„ã€‚

### æ ¸å¿ƒæ¶æ„
- âœ… ç›´æ¥è°ƒç”¨ **Claude CLI**ï¼ˆå‘½ä»¤è¡Œå·¥å…·ï¼‰
- âœ… ä½¿ç”¨ **MCP (Model Context Protocol)** è¿›è¡Œå·¥å…·è°ƒç”¨
- âœ… ä»…ä½¿ç”¨ **OpenAI SDK** ç”¨äºè®°å¿†ç³»ç»Ÿçš„å‘é‡åµŒå…¥ï¼ˆå¯é€‰ï¼‰

### å¦‚ä½•æ”¯æŒ Claude

#### æ–¹å¼ 1ï¼šç›´æ¥è°ƒç”¨ Claude CLI

```typescript
// src/claude.ts å’Œ src/commands/runner.ts
const Cmd = [
  "claude",                    // Claude CLI å‘½ä»¤
  "--model", "opus",           // ä½¿ç”¨ Claude Opus æ¨¡å‹
  "--verbose",
  "--output-format", "stream-json",
  "--dangerously-skip-permissions",
  "-p", opts.prompt,           // ä¼ å…¥æç¤ºè¯
];

// ä½¿ç”¨ Bun.spawn å¯åŠ¨ Claude è¿›ç¨‹
const proc = Bun.spawn(Cmd, {
  env: freshEnv,
  stdout: "pipe",
  stderr: "pipe",
});
```

**å…³é”®ç‚¹**ï¼š
- ä¸æ˜¯é€šè¿‡ API è°ƒç”¨ï¼Œè€Œæ˜¯ç›´æ¥è¿è¡Œ `claude` å‘½ä»¤è¡Œå·¥å…·
- éœ€è¦ `CLAUDE_CODE_OAUTH_TOKEN` ç¯å¢ƒå˜é‡è¿›è¡Œè®¤è¯
- è¾“å‡ºæ ¼å¼ä¸ºæµå¼ JSONï¼Œé€è¡Œè§£æ

#### æ–¹å¼ 2ï¼šMCP å·¥å…·ç³»ç»Ÿ

```typescript
// src/server.ts - æ³¨å†Œ MCP å·¥å…·
registerJoinSwarmTool(server);
registerPollTaskTool(server);
registerSendTaskTool(server);
// ... 50+ å·¥å…·
```

Claude é€šè¿‡ MCP åè®®è°ƒç”¨è¿™äº›å·¥å…·æ¥ï¼š
- åŠ å…¥é›†ç¾¤ï¼ˆjoin-swarmï¼‰
- è½®è¯¢ä»»åŠ¡ï¼ˆpoll-taskï¼‰
- å‘é€ä»»åŠ¡ï¼ˆsend-taskï¼‰
- å­˜å‚¨è¿›åº¦ï¼ˆstore-progressï¼‰
- æœç´¢è®°å¿†ï¼ˆmemory-searchï¼‰

#### æ–¹å¼ 3ï¼šHook ç³»ç»Ÿ

```typescript
// src/hooks/hook.ts - 6 ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­
SessionStart    // ä¼šè¯å¼€å§‹
PreCompact      // ä¸Šä¸‹æ–‡å‹ç¼©å‰
PreToolUse      // å·¥å…·è°ƒç”¨å‰
PostToolUse     // å·¥å…·è°ƒç”¨å
UserPromptSubmit // æ–°è¿­ä»£å¼€å§‹
Stop            // ä¼šè¯ç»“æŸ
```

è¿™äº›é’©å­æ‹¦æˆª Claude çš„æ‰§è¡Œæµç¨‹ï¼Œå®ç°ï¼š
- ä»»åŠ¡å–æ¶ˆæ£€æµ‹
- å·¥å…·å¾ªç¯æ£€æµ‹
- èº«ä»½æ–‡ä»¶åŒæ­¥
- è®°å¿†è‡ªåŠ¨ç´¢å¼•
- ä¼šè¯æ€»ç»“

---

## ğŸ”„ å¦‚ä½•æ”¯æŒ DeepSeek

### æ–¹æ¡ˆ 1ï¼šæ›¿æ¢ Claude CLIï¼ˆæ¨èï¼‰

å¦‚æœ DeepSeek æä¾›äº†ç±»ä¼¼çš„ CLI å·¥å…·ï¼š

#### 1. ä¿®æ”¹ `src/commands/runner.ts`

```typescript
// åœ¨ runClaudeIteration å’Œ spawnClaudeProcess å‡½æ•°ä¸­
// åŸä»£ç ï¼š
const Cmd = [
  "claude",
  "--model", "opus",
  // ...
];

// ä¿®æ”¹ä¸ºï¼š
const cliTool = process.env.AI_CLI_TOOL || "claude";  // æ”¯æŒé…ç½®
const model = process.env.AI_MODEL || "opus";

const Cmd = [
  cliTool,  // å¯ä»¥æ˜¯ "deepseek" æˆ–å…¶ä»–
  "--model", model,
  // ... å…¶ä»–å‚æ•°éœ€è¦æ ¹æ® DeepSeek CLI è°ƒæ•´
];
```

#### 2. æ·»åŠ ç¯å¢ƒå˜é‡æ”¯æŒ

```bash
# .env.docker
AI_CLI_TOOL=deepseek           # CLI å·¥å…·åç§°
AI_MODEL=deepseek-coder        # æ¨¡å‹åç§°
DEEPSEEK_API_KEY=your-key      # DeepSeek API Key
```

#### 3. ä¿®æ”¹ Dockerfile.worker

```dockerfile
# åœ¨ Dockerfile.worker ä¸­å®‰è£… DeepSeek CLI
RUN npm install -g @deepseek/cli  # å‡è®¾æœ‰è¿™æ ·çš„åŒ…
# æˆ–è€…
RUN curl -fsSL https://deepseek.com/install.sh | bash
```

### æ–¹æ¡ˆ 2ï¼šé€šè¿‡ API é€‚é…ï¼ˆæ›´çµæ´»ï¼‰

å¦‚æœ DeepSeek åªæä¾› APIï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªé€‚é…å±‚ï¼š

#### 1. åˆ›å»º `src/adapters/deepseek.ts`

```typescript
import OpenAI from "openai";  // DeepSeek å…¼å®¹ OpenAI SDK

export class DeepSeekAdapter {
  private client: OpenAI;

  constructor() {
    this.client = new OpenAI({
      apiKey: process.env.DEEPSEEK_API_KEY,
      baseURL: "https://api.deepseek.com/v1",  // DeepSeek API ç«¯ç‚¹
    });
  }

  async chat(opts: {
    prompt: string;
    systemPrompt?: string;
    onChunk: (json: any) => void;
  }): Promise<{ exitCode: number }> {
    try {
      const messages = [
        { role: "system", content: opts.systemPrompt || "" },
        { role: "user", content: opts.prompt },
      ];

      const stream = await this.client.chat.completions.create({
        model: "deepseek-coder",
        messages,
        stream: true,
        tools: this.getTools(),  // MCP å·¥å…·è½¬æ¢ä¸º OpenAI æ ¼å¼
      });

      for await (const chunk of stream) {
        // è½¬æ¢ä¸º Claude CLI å…¼å®¹çš„ JSON æ ¼å¼
        const claudeFormat = this.convertToClaudeFormat(chunk);
        opts.onChunk(claudeFormat);
      }

      return { exitCode: 0 };
    } catch (error) {
      console.error("DeepSeek API error:", error);
      return { exitCode: 1 };
    }
  }

  private getTools() {
    // ä» MCP server è·å–å·¥å…·å®šä¹‰å¹¶è½¬æ¢ä¸º OpenAI æ ¼å¼
    return [
      {
        type: "function",
        function: {
          name: "join-swarm",
          description: "Join the agent swarm",
          parameters: {
            type: "object",
            properties: {
              name: { type: "string" },
              lead: { type: "boolean" },
            },
          },
        },
      },
      // ... å…¶ä»–å·¥å…·
    ];
  }

  private convertToClaudeFormat(chunk: any) {
    // å°† DeepSeek/OpenAI çš„æµå¼å“åº”è½¬æ¢ä¸º Claude CLI çš„ JSON æ ¼å¼
    if (chunk.choices[0]?.delta?.content) {
      return {
        type: "text",
        text: chunk.choices[0].delta.content,
      };
    }
    
    if (chunk.choices[0]?.delta?.tool_calls) {
      const toolCall = chunk.choices[0].delta.tool_calls[0];
      return {
        type: "tool_use",
        name: toolCall.function.name,
        input: JSON.parse(toolCall.function.arguments),
      };
    }
    
    return null;
  }
}
```

#### 2. ä¿®æ”¹ `src/commands/runner.ts`

```typescript
import { DeepSeekAdapter } from "../adapters/deepseek";

async function runClaudeIteration(opts: RunClaudeIterationOptions) {
  const aiProvider = process.env.AI_PROVIDER || "claude";
  
  if (aiProvider === "deepseek") {
    // ä½¿ç”¨ DeepSeek é€‚é…å™¨
    const adapter = new DeepSeekAdapter();
    const logFileHandle = Bun.file(opts.logFile).writer();
    
    const result = await adapter.chat({
      prompt: opts.prompt,
      systemPrompt: opts.systemPrompt,
      onChunk: (json) => {
        if (json) {
          const line = JSON.stringify(json);
          logFileHandle.write(line + "\n");
          prettyPrintLine(line, opts.role);
        }
      },
    });
    
    await logFileHandle.end();
    return { exitCode: result.exitCode, errorTracker: new SessionErrorTracker() };
  }
  
  // åŸæœ‰çš„ Claude CLI é€»è¾‘
  const Cmd = ["claude", ...];
  // ...
}
```

### æ–¹æ¡ˆ 3ï¼šæ··åˆæ¨¡å¼ï¼ˆæœ€çµæ´»ï¼‰

æ”¯æŒå¤šä¸ª AI æä¾›å•†ï¼Œè®©ä¸åŒçš„ Worker ä½¿ç”¨ä¸åŒçš„æ¨¡å‹ï¼š

```yaml
# docker-compose.yml
services:
  worker-claude:
    environment:
      - AI_PROVIDER=claude
      - CLAUDE_CODE_OAUTH_TOKEN=xxx
      
  worker-deepseek:
    environment:
      - AI_PROVIDER=deepseek
      - DEEPSEEK_API_KEY=xxx
      
  worker-gemini:
    environment:
      - AI_PROVIDER=gemini
      - GEMINI_API_KEY=xxx
```

### å…³é”®ä¿®æ”¹ç‚¹æ€»ç»“

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|---------|
| `src/commands/runner.ts` | æ·»åŠ  AI æä¾›å•†é€‰æ‹©é€»è¾‘ |
| `src/adapters/deepseek.ts` | åˆ›å»º DeepSeek é€‚é…å™¨ï¼ˆæ–°æ–‡ä»¶ï¼‰ |
| `Dockerfile.worker` | å®‰è£… DeepSeek CLI æˆ– SDK |
| `.env.docker` | æ·»åŠ  DeepSeek é…ç½®å˜é‡ |
| `src/utils/pretty-print.ts` | å¯èƒ½éœ€è¦è°ƒæ•´æ—¥å¿—æ ¼å¼åŒ– |

### æ³¨æ„äº‹é¡¹

1. **å·¥å…·è°ƒç”¨æ ¼å¼**ï¼šDeepSeek çš„å·¥å…·è°ƒç”¨æ ¼å¼å¯èƒ½ä¸ Claude ä¸åŒï¼Œéœ€è¦é€‚é…
2. **æµå¼è¾“å‡º**ï¼šç¡®ä¿ DeepSeek æ”¯æŒæµå¼è¾“å‡ºï¼Œå¦åˆ™ç”¨æˆ·ä½“éªŒä¼šå˜å·®
3. **æˆæœ¬è¿½è¸ª**ï¼šä¿®æ”¹ `session_costs` è¡¨çš„æˆæœ¬è®¡ç®—é€»è¾‘
4. **Hook ç³»ç»Ÿ**ï¼šæŸäº› Hook å¯èƒ½ä¾èµ– Claude ç‰¹å®šçš„è¾“å‡ºæ ¼å¼
5. **MCP å…¼å®¹æ€§**ï¼šDeepSeek éœ€è¦æ”¯æŒ MCP åè®®æˆ–é€šè¿‡é€‚é…å™¨è½¬æ¢

### æ¨èæ–¹æ¡ˆ

- **å¦‚æœ DeepSeek æœ‰ CLI å·¥å…·** â†’ ä½¿ç”¨æ–¹æ¡ˆ 1ï¼ˆæœ€ç®€å•ï¼‰
- **å¦‚æœåªæœ‰ API** â†’ ä½¿ç”¨æ–¹æ¡ˆ 2ï¼ˆéœ€è¦é€‚é…å±‚ï¼‰
- **å¦‚æœè¦æ”¯æŒå¤šä¸ªæ¨¡å‹** â†’ ä½¿ç”¨æ–¹æ¡ˆ 3ï¼ˆæœ€çµæ´»ï¼‰

---

## ğŸ“¦ ç¬¬ä¸‰æ–¹åº“ä¾èµ–åˆ†æ

### æ ¸å¿ƒé¡¹ç›®ä¾èµ–ï¼ˆä¸»é¡¹ç›® package.jsonï¼‰

#### ğŸ¯ æ ¸å¿ƒåè®®ä¸é€šä¿¡

##### 1. @modelcontextprotocol/sdk (^1.25.1)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… å®ç° MCP (Model Context Protocol) åè®®
- âœ… è®© AI æ¨¡å‹èƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å·¥å…·ï¼ˆç±»ä¼¼ Function Callingï¼‰
- âœ… æä¾›æ ‡å‡†åŒ–çš„å·¥å…·æ³¨å†Œã€è°ƒç”¨ã€å“åº”æœºåˆ¶

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/server.ts
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";

const server = new McpServer({
  name: "agent-swarm",
  version: "1.28.1",
});

// æ³¨å†Œå·¥å…·ä¾› Claude è°ƒç”¨
registerJoinSwarmTool(server);
registerPollTaskTool(server);
```

**ä¸ºä»€ä¹ˆé‡è¦**ï¼šè¿™æ˜¯æ•´ä¸ªé¡¹ç›®çš„æ ¸å¿ƒï¼Œæ²¡æœ‰å®ƒå°±æ— æ³•å®ç° AI ä»£ç†ä¸ç³»ç»Ÿçš„äº¤äº’ã€‚

---

##### 2. hono (^4.12.3)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… è½»é‡çº§ã€é«˜æ€§èƒ½çš„ HTTP æœåŠ¡å™¨æ¡†æ¶
- âœ… æ”¯æŒå¤šç§è¿è¡Œæ—¶ï¼ˆBunã€Node.jsã€Cloudflare Workersï¼‰
- âœ… æä¾›è·¯ç”±ã€ä¸­é—´ä»¶ã€ç±»å‹å®‰å…¨çš„ API

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/http.ts
import { Hono } from "hono";

const app = new Hono();

app.post("/mcp", async (c) => {
  // MCP åè®®ç«¯ç‚¹
});

app.get("/api/agents", async (c) => {
  // REST API ç«¯ç‚¹
});
```

**ä¸ºä»€ä¹ˆé€‰æ‹© Hono**ï¼š
- æ¯” Express å¿« 4 å€
- åŸç”Ÿæ”¯æŒ Bun
- TypeScript ç±»å‹æ¨å¯¼ä¼˜ç§€

---

#### ğŸ’¬ é›†æˆä¸é€šä¿¡

##### 3. @slack/bolt (^4.6.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… Slack åº”ç”¨å¼€å‘æ¡†æ¶
- âœ… å¤„ç† Slack äº‹ä»¶ã€å‘½ä»¤ã€äº¤äº’
- âœ… Socket Mode æ”¯æŒï¼ˆæ— éœ€å…¬ç½‘ webhookï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/slack/app.ts
import { App } from "@slack/bolt";

const app = new App({
  token: process.env.SLACK_BOT_TOKEN,
  socketMode: true,
  appToken: process.env.SLACK_APP_TOKEN,
});

// ç›‘å¬ç›´æ¥æ¶ˆæ¯
app.message(async ({ message, say }) => {
  // åˆ›å»ºä»»åŠ¡
  await createTaskFromSlackMessage(message);
});
```

**è§£å†³çš„ä¸šåŠ¡é—®é¢˜**ï¼š
- ç”¨æˆ·å¯ä»¥é€šè¿‡ Slack ç›´æ¥ä¸ AI ä»£ç†å¯¹è¯
- ä»»åŠ¡è¿›åº¦è‡ªåŠ¨å›å¤åˆ° Slack çº¿ç¨‹
- å›¢é˜Ÿåä½œåœºæ™¯ä¸‹çš„ä»»åŠ¡åˆ†é…

---

##### 4. svix (^1.62.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… Webhook éªŒè¯å’Œç­¾å
- âœ… ç”¨äº AgentMail é›†æˆçš„å®‰å…¨éªŒè¯

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/agentmail/handlers.ts
import { Webhook } from "svix";

const wh = new Webhook(process.env.AGENTMAIL_WEBHOOK_SECRET);
const payload = wh.verify(body, headers);
```

**ä¸ºä»€ä¹ˆéœ€è¦**ï¼šç¡®ä¿ webhook è¯·æ±‚æ¥è‡ªå¯ä¿¡æ¥æºï¼Œé˜²æ­¢ä¼ªé€ æ”»å‡»ã€‚

---

#### ğŸ—“ï¸ æ—¶é—´ä¸è°ƒåº¦

##### 5. cron-parser (^5.4.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… è§£æ Cron è¡¨è¾¾å¼
- âœ… è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
- âœ… æ”¯æŒå®šæ—¶ä»»åŠ¡è°ƒåº¦

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/scheduler/scheduler.ts
import parser from "cron-parser";

const interval = parser.parseExpression("0 9 * * *", {
  currentDate: new Date(),
  tz: "UTC",
});

const nextRun = interval.next().toDate();
```

**è§£å†³çš„ä¸šåŠ¡é—®é¢˜**ï¼š
- å®šæ—¶ä»£ç å®¡è®¡
- å®šæœŸä¾èµ–æ›´æ–°æ£€æŸ¥
- æ¯æ—¥æŠ¥å‘Šç”Ÿæˆ

---

##### 6. date-fns (^4.1.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… ç°ä»£åŒ–çš„æ—¥æœŸå¤„ç†åº“ï¼ˆæ›¿ä»£ moment.jsï¼‰
- âœ… Tree-shakableï¼ˆæŒ‰éœ€å¼•å…¥ï¼‰
- âœ… ä¸å¯å˜ã€å‡½æ•°å¼ API

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
import { addMinutes, formatDuration } from "date-fns";

const maxTime = addMinutes(now, 60);
const duration = formatDuration({ seconds: elapsed });
```

**ä¸ºä»€ä¹ˆé€‰æ‹© date-fns**ï¼š
- æ¯” moment.js å° 97%
- æ”¯æŒ TypeScript
- æ›´å¥½çš„æ€§èƒ½

---

#### âœ… æ•°æ®éªŒè¯

##### 7. zod (^4.2.1)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… TypeScript ä¼˜å…ˆçš„ schema éªŒè¯
- âœ… è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥
- âœ… è‡ªåŠ¨ç±»å‹æ¨å¯¼

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/types.ts
import * as z from "zod";

export const AgentTaskSchema = z.object({
  id: z.uuid(),
  task: z.string().min(1),
  status: z.enum(["pending", "in_progress", "completed"]),
  priority: z.number().int().min(0).max(100).default(50),
});

export type AgentTask = z.infer<typeof AgentTaskSchema>;
```

**ä¸ºä»€ä¹ˆé‡è¦**ï¼š
- ç¡®ä¿ API è¾“å…¥è¾“å‡ºçš„ç±»å‹å®‰å…¨
- è‡ªåŠ¨ç”Ÿæˆ TypeScript ç±»å‹
- æä¾›å‹å¥½çš„é”™è¯¯æ¶ˆæ¯

---

#### ğŸ¤– AI ä¸åµŒå…¥

##### 8. openai (^6.22.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… OpenAI API å®¢æˆ·ç«¯
- âœ… ç”¨äºè®°å¿†ç³»ç»Ÿçš„å‘é‡åµŒå…¥ï¼ˆtext-embedding-3-smallï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/be/embedding.ts
import OpenAI from "openai";

const client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

const response = await client.embeddings.create({
  model: "text-embedding-3-small",
  input: text,
  dimensions: 512,
});
```

**è§£å†³çš„ä¸šåŠ¡é—®é¢˜**ï¼š
- ä»£ç†è®°å¿†çš„è¯­ä¹‰æœç´¢
- ç›¸å…³ç»éªŒçš„è‡ªåŠ¨æ£€ç´¢
- çŸ¥è¯†åº“çš„æ™ºèƒ½åŒ¹é…

---

#### ğŸ–¥ï¸ ç»ˆç«¯ UI

##### 9. ink (^6.5.1) + @inkjs/ui (^2.0.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… ä½¿ç”¨ React æ„å»ºç»ˆç«¯ UI
- âœ… äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢
- âœ… ç»„ä»¶åŒ–çš„ CLI å¼€å‘

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/cli.tsx
import { Box, Text, render } from "ink";
import { Spinner } from "@inkjs/ui";

function Setup() {
  return (
    <Box flexDirection="column">
      <Text color="green">âœ“ Setup complete</Text>
      <Spinner label="Installing..." />
    </Box>
  );
}

render(<Setup />);
```

**ä¸ºä»€ä¹ˆä½¿ç”¨ Ink**ï¼š
- ç†Ÿæ‚‰çš„ React å¼€å‘ä½“éªŒ
- ä¸°å¯Œçš„ UI ç»„ä»¶
- æ›´å¥½çš„ä»£ç ç»„ç»‡

---

##### 10. react (^19.2.3) + react-devtools-core (^7.0.1)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… Ink çš„ä¾èµ–ï¼ˆç”¨äº CLI UIï¼‰
- âœ… React DevTools ç”¨äºè°ƒè¯•ç»ˆç«¯ UI

---

#### ğŸŒ ç½‘ç»œå·¥å…·

##### 11. @desplega.ai/localtunnel (^2.2.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… æœ¬åœ°æœåŠ¡æš´éœ²åˆ°å…¬ç½‘
- âœ… ç”¨äº Artifact SDKï¼ˆä»£ç†è¿è¡Œçš„ Web æœåŠ¡ï¼‰
- âœ… æ— éœ€é…ç½® ngrok æˆ–åå‘ä»£ç†

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// src/artifact-sdk/tunnel.ts
import localtunnel from "@desplega.ai/localtunnel";

const tunnel = await localtunnel({ port: 3000 });
console.log(`Service available at: ${tunnel.url}`);
```

**è§£å†³çš„ä¸šåŠ¡é—®é¢˜**ï¼š
- Worker ä»£ç†å¯ä»¥è¿è¡Œ Web æœåŠ¡
- å…¶ä»–ä»£ç†å¯ä»¥å‘ç°å’Œè®¿é—®è¿™äº›æœåŠ¡
- æ— éœ€å¤æ‚çš„ç½‘ç»œé…ç½®

---

#### ğŸ› ï¸ å¼€å‘å·¥å…·

##### 12. @biomejs/biome (^2.3.10)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… å¿«é€Ÿçš„ Linter + Formatterï¼ˆæ›¿ä»£ ESLint + Prettierï¼‰
- âœ… ç”¨ Rust ç¼–å†™ï¼Œé€Ÿåº¦å¿« 100 å€
- âœ… é›¶é…ç½®å¼€ç®±å³ç”¨

**ä½¿ç”¨åœºæ™¯**ï¼š
```bash
bun run lint:fix  # è‡ªåŠ¨ä¿®å¤ä»£ç é£æ ¼é—®é¢˜
```

**ä¸ºä»€ä¹ˆé€‰æ‹© Biome**ï¼š
- æ¯” ESLint + Prettier å¿« 100 å€
- å•ä¸€å·¥å…·ï¼Œé…ç½®ç®€å•
- æ›´å¥½çš„é”™è¯¯æç¤º

---

### å‰ç«¯é¡¹ç›®ä¾èµ–åˆ†æï¼ˆnew-ui/package.jsonï¼‰

#### UI æ¡†æ¶ä¸è·¯ç”±

##### 13. react-router-dom (^7.13.1)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… å•é¡µåº”ç”¨è·¯ç”±
- âœ… é¡µé¢å¯¼èˆªå’ŒçŠ¶æ€ç®¡ç†

---

##### 14. @tanstack/react-query (^5.90.21)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†
- âœ… è‡ªåŠ¨ç¼“å­˜ã€é‡æ–°è·å–ã€è½®è¯¢
- âœ… ä¹è§‚æ›´æ–°

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
// new-ui/src/api/hooks/use-agents.ts
import { useQuery } from "@tanstack/react-query";

export function useAgents() {
  return useQuery({
    queryKey: ["agents"],
    queryFn: () => fetch("/api/agents").then(r => r.json()),
    refetchInterval: 5000,  // æ¯ 5 ç§’åˆ·æ–°
  });
}
```

**ä¸ºä»€ä¹ˆé‡è¦**ï¼šå®æ—¶ç›‘æ§ä»£ç†çŠ¶æ€ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç† WebSocketã€‚

---

#### UI ç»„ä»¶åº“

##### 15. radix-ui (^1.4.3) + lucide-react (^0.575.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… æ— æ ·å¼ã€å¯è®¿é—®çš„ UI ç»„ä»¶ï¼ˆRadixï¼‰
- âœ… ç°ä»£åŒ–å›¾æ ‡åº“ï¼ˆLucideï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
import * as Dialog from "@radix-ui/react-dialog";
import { CheckCircle } from "lucide-react";

<Dialog.Root>
  <Dialog.Trigger>
    <CheckCircle /> Open
  </Dialog.Trigger>
</Dialog.Root>
```

---

##### 16. ag-grid-react (^35.1.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… ä¼ä¸šçº§æ•°æ®è¡¨æ ¼
- âœ… è™šæ‹Ÿæ»šåŠ¨ã€æ’åºã€è¿‡æ»¤
- âœ… å¤„ç†å¤§é‡æ•°æ®ï¼ˆä»»åŠ¡åˆ—è¡¨ã€æ—¥å¿—ï¼‰

---

##### 17. recharts (^3.7.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… React å›¾è¡¨åº“
- âœ… å¯è§†åŒ–ä»£ç†æ€§èƒ½ã€æˆæœ¬ç»Ÿè®¡

---

#### æ ·å¼å·¥å…·

##### 18. tailwindcss (^4.2.1) + class-variance-authority (^0.7.1)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
- âœ… ç±»å‹å®‰å…¨çš„å˜ä½“ç®¡ç†ï¼ˆCVAï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼š
```typescript
import { cva } from "class-variance-authority";

const button = cva("px-4 py-2 rounded", {
  variants: {
    intent: {
      primary: "bg-blue-500 text-white",
      secondary: "bg-gray-200 text-black",
    },
  },
});
```

---

#### Markdown æ¸²æŸ“

##### 19. react-markdown (^10.1.0) + remark-gfm (^4.0.1)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… æ¸²æŸ“ Markdown å†…å®¹ï¼ˆä»»åŠ¡æè¿°ã€ä»£ç†è¾“å‡ºï¼‰
- âœ… æ”¯æŒ GitHub Flavored Markdownï¼ˆè¡¨æ ¼ã€ä»»åŠ¡åˆ—è¡¨ï¼‰

---

#### é€šçŸ¥ä¸äº¤äº’

##### 20. sonner (^2.0.7)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… ä¼˜é›…çš„ Toast é€šçŸ¥
- âœ… æ“ä½œåé¦ˆï¼ˆä»»åŠ¡åˆ›å»ºã€é”™è¯¯æç¤ºï¼‰

---

##### 21. cmdk (^1.1.1)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… å‘½ä»¤é¢æ¿ï¼ˆCmd+Kï¼‰
- âœ… å¿«é€Ÿå¯¼èˆªå’Œæ“ä½œ

---

### æ–‡æ¡£ç«™ç‚¹ä¾èµ–åˆ†æï¼ˆdocs-site/package.jsonï¼‰

##### 22. fumadocs-ui (^16.6.0) + fumadocs-mdx (^14.2.0)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… ç°ä»£åŒ–æ–‡æ¡£ç«™ç‚¹æ¡†æ¶
- âœ… MDX æ”¯æŒï¼ˆMarkdown + React ç»„ä»¶ï¼‰
- âœ… æœç´¢ã€å¯¼èˆªã€ä¸»é¢˜åˆ‡æ¢

---

##### 23. mermaid (^11.12.3)

**è§£å†³çš„é—®é¢˜**ï¼š
- âœ… å›¾è¡¨å’Œæµç¨‹å›¾æ¸²æŸ“
- âœ… æ¶æ„å›¾å¯è§†åŒ–

---

## ğŸ¯ ä¾èµ–é€‰æ‹©çš„æ ¸å¿ƒåŸåˆ™

### 1. æ€§èƒ½ä¼˜å…ˆ
- **Hono**ï¼ˆæ¯” Express å¿« 4 å€ï¼‰
- **Biome**ï¼ˆæ¯” ESLint å¿« 100 å€ï¼‰
- **date-fns**ï¼ˆæ¯” moment.js å° 97%ï¼‰

### 2. TypeScript ä¼˜å…ˆ
- **Zod**ï¼ˆç±»å‹å®‰å…¨çš„éªŒè¯ï¼‰
- **Hono**ï¼ˆå®Œæ•´çš„ç±»å‹æ¨å¯¼ï¼‰
- **TanStack Query**ï¼ˆç±»å‹å®‰å…¨çš„æ•°æ®è·å–ï¼‰

### 3. Bun ç”Ÿæ€
- åŸç”Ÿæ”¯æŒ Bun çš„åº“
- é¿å… Node.js ç‰¹å®šçš„ä¾èµ–

### 4. ç°ä»£åŒ–å·¥å…·é“¾
- **React 19**ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰
- **Tailwind CSS 4**ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
- **Vite 7**ï¼ˆå¿«é€Ÿæ„å»ºï¼‰

---

## ğŸ“Š ä¾èµ–ç»Ÿè®¡

| ç±»åˆ« | æ•°é‡ | æ ¸å¿ƒåº“ |
|------|------|--------|
| **åè®®ä¸é€šä¿¡** | 3 | MCP SDK, Hono, Slack Bolt |
| **æ•°æ®éªŒè¯** | 1 | Zod |
| **AI é›†æˆ** | 1 | OpenAI |
| **æ—¶é—´å¤„ç†** | 2 | date-fns, cron-parser |
| **ç»ˆç«¯ UI** | 2 | Ink, @inkjs/ui |
| **å‰ç«¯æ¡†æ¶** | 10+ | React, TanStack Query, Radix UI |
| **å¼€å‘å·¥å…·** | 2 | Biome, TypeScript |

---

## ğŸ’¡ å…³é”®è®¾è®¡å†³ç­–

### âœ… ä¸ºä»€ä¹ˆä¸ç”¨ Expressï¼Ÿ
â†’ Hono æ›´å¿«ã€æ›´ç°ä»£ã€åŸç”Ÿæ”¯æŒ Bun

### âœ… ä¸ºä»€ä¹ˆä¸ç”¨ Prismaï¼Ÿ
â†’ ç›´æ¥ä½¿ç”¨ `bun:sqlite`ï¼Œæ›´è½»é‡ã€æ›´å¿«

### âœ… ä¸ºä»€ä¹ˆä¸ç”¨ LangChainï¼Ÿ
â†’ ç›´æ¥è°ƒç”¨ Claude CLIï¼Œæ›´ç®€å•ã€æ›´å¯æ§

### âœ… ä¸ºä»€ä¹ˆç”¨ Ink è€Œä¸æ˜¯ Commanderï¼Ÿ
â†’ React ç»„ä»¶åŒ–å¼€å‘ï¼Œæ›´å¥½çš„ UI ä½“éªŒ

### âœ… ä¸ºä»€ä¹ˆç”¨ Zod è€Œä¸æ˜¯ Joiï¼Ÿ
â†’ TypeScript ä¼˜å…ˆï¼Œè‡ªåŠ¨ç±»å‹æ¨å¯¼

---

## ğŸ¯ æ€»ç»“ï¼šä¾èµ–è§£å†³çš„æ ¸å¿ƒé—®é¢˜

1. **MCP SDK** â†’ AI å·¥å…·è°ƒç”¨çš„æ ‡å‡†åŒ–
2. **Hono** â†’ é«˜æ€§èƒ½ HTTP æœåŠ¡
3. **Slack Bolt** â†’ å›¢é˜Ÿåä½œé›†æˆ
4. **Zod** â†’ ç±»å‹å®‰å…¨çš„æ•°æ®éªŒè¯
5. **OpenAI** â†’ è¯­ä¹‰æœç´¢å’Œè®°å¿†ç³»ç»Ÿ
6. **Ink** â†’ ç°ä»£åŒ–çš„ CLI ä½“éªŒ
7. **TanStack Query** â†’ å®æ—¶æ•°æ®åŒæ­¥
8. **Biome** â†’ å¿«é€Ÿçš„ä»£ç è´¨é‡æ£€æŸ¥

è¿™ä¸ªé¡¹ç›®çš„ä¾èµ–é€‰æ‹©éå¸¸ç²¾ç®€ä¸”ç°ä»£åŒ–ï¼Œé¿å…äº†è¿‡åº¦ä¾èµ–ï¼Œæ¯ä¸ªåº“éƒ½æœ‰æ˜ç¡®çš„èŒè´£å’Œä¸å¯æ›¿ä»£çš„ä»·å€¼ã€‚

---

## ğŸ“ æ–‡æ¡£ç”Ÿæˆä¿¡æ¯

- **ç”Ÿæˆæ—¶é—´**: 2025-02-27
- **é¡¹ç›®ç‰ˆæœ¬**: 1.28.1
- **æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
- **ç»´æŠ¤è€…**: Agent Swarm Team

---

## ğŸ”— ç›¸å…³èµ„æº

- **é¡¹ç›®ä»“åº“**: https://github.com/desplega-ai/agent-swarm
- **æ–‡æ¡£ç«™ç‚¹**: https://docs.agent-swarm.dev
- **ä»ªè¡¨æ¿**: https://app.agent-swarm.dev
- **Discord ç¤¾åŒº**: https://discord.gg/KZgfyyDVZa

---

**æœ¬æ–‡æ¡£æ¶µç›–äº† Agent Swarm é¡¹ç›®çš„å®Œæ•´æ¶æ„åˆ†æï¼ŒåŒ…æ‹¬æŠ€æœ¯æ ˆã€æ•°æ®æ¨¡å‹ã€æ ¸å¿ƒåŠŸèƒ½ã€AI æ¨¡å‹é›†æˆæ–¹æ¡ˆä»¥åŠç¬¬ä¸‰æ–¹ä¾èµ–çš„è¯¦ç»†è¯´æ˜ã€‚**

